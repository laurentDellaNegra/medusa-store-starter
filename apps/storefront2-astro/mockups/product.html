<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Product — Rafia</title>
<link rel="stylesheet" href="shared.css">
<style>
  .pdp { padding: 9rem 4rem 6rem; max-width: 1400px; margin: 0 auto; }
  .pdp-grid { display: grid; grid-template-columns: 1.1fr 1fr; gap: 5rem; align-items: start; }

  /* Image side */
  .pdp-gallery { position: sticky; top: 7rem; }
  .pdp-main-image {
    aspect-ratio: 3/4; position: relative; overflow: hidden; margin-bottom: 1rem;
  }
  .pdp-main-bg { position: absolute; inset: 0; }
  .pdp-main-shape {
    position: absolute; inset: 0;
    display: flex; align-items: center; justify-content: center;
  }
  .pdp-main-shape svg {
    width: 55%; height: auto;
    filter: drop-shadow(0 25px 60px rgba(44,24,16,0.2));
    animation: floatBag 4s ease-in-out infinite;
  }
  @keyframes floatBag {
    0%, 100% { transform: translateY(0) rotate(0deg); }
    50% { transform: translateY(-12px) rotate(-1.5deg); }
  }
  .pdp-badge-abs {
    position: absolute; top: 1.5rem; left: 1.5rem;
    padding: 0.5rem 1.2rem; background: rgba(255,252,247,0.9); backdrop-filter: blur(10px);
    font-size: 0.6rem; letter-spacing: 0.2em; text-transform: uppercase; color: var(--gold); z-index: 2;
  }
  .pdp-thumbs { display: flex; gap: 0.8rem; }
  .pdp-thumb {
    width: 80px; height: 100px; position: relative; overflow: hidden;
    border: 2px solid var(--sand); cursor: pointer; transition: border-color 0.3s;
    display: flex; align-items: center; justify-content: center;
  }
  .pdp-thumb.active, .pdp-thumb:hover { border-color: var(--gold); }
  .pdp-thumb svg { width: 50%; height: auto; }

  /* Info side */
  .pdp-info { padding-top: 1rem; }
  .pdp-breadcrumb {
    font-size: 0.7rem; letter-spacing: 0.12em; text-transform: uppercase;
    color: var(--espresso-soft); margin-bottom: 2rem;
  }
  .pdp-breadcrumb a { color: var(--gold); text-decoration: none; transition: color 0.3s; }
  .pdp-breadcrumb a:hover { color: var(--espresso); }
  .pdp-breadcrumb .sep { margin: 0 0.6rem; color: var(--sand); }
  .pdp-type {
    font-size: 0.65rem; letter-spacing: 0.3em; text-transform: uppercase;
    color: var(--gold); margin-bottom: 0.8rem;
  }
  .pdp-name {
    font-family: 'Cormorant Garamond', serif;
    font-size: clamp(2.2rem, 3.5vw, 3.2rem); font-weight: 300; line-height: 1.1;
    margin-bottom: 1rem;
  }
  .pdp-price {
    font-family: 'Cormorant Garamond', serif;
    font-size: 1.8rem; color: var(--gold); margin-bottom: 2rem;
  }
  .pdp-divider { width: 40px; height: 1px; background: var(--gold); margin: 2rem 0; }
  .pdp-desc {
    font-size: 0.95rem; line-height: 1.9; color: var(--espresso-soft); margin-bottom: 2rem;
  }

  /* Color selector */
  .pdp-option-label {
    font-size: 0.65rem; letter-spacing: 0.2em; text-transform: uppercase;
    color: var(--espresso-soft); margin-bottom: 0.8rem;
  }
  .pdp-color-row { display: flex; gap: 0.8rem; margin-bottom: 2rem; }
  .color-swatch {
    width: 32px; height: 32px; border-radius: 50%; cursor: pointer;
    border: 2px solid transparent; transition: all 0.3s; position: relative;
  }
  .color-swatch.active { border-color: var(--espresso); }
  .color-swatch::after {
    content: ''; position: absolute; inset: -4px; border-radius: 50%;
    border: 1px solid transparent; transition: border-color 0.3s;
  }
  .color-swatch.active::after { border-color: var(--gold); }
  .sw-natural { background: #D4C5B2; }
  .sw-honey { background: #C4A872; }
  .sw-sand { background: #BFA98E; }

  /* Quantity */
  .pdp-qty-row { display: flex; align-items: center; gap: 1.5rem; margin-bottom: 2.5rem; }
  .qty-control {
    display: flex; align-items: center; border: 1px solid var(--sand);
  }
  .qty-btn {
    width: 44px; height: 44px; border: none; background: transparent;
    font-size: 1.1rem; color: var(--espresso); cursor: pointer;
    font-family: 'Outfit', sans-serif; transition: background 0.3s;
  }
  .qty-btn:hover { background: var(--sand-pale); }
  .qty-val {
    width: 50px; text-align: center; border: none; border-left: 1px solid var(--sand);
    border-right: 1px solid var(--sand); font-family: 'Outfit', sans-serif;
    font-size: 0.85rem; height: 44px; background: transparent; color: var(--espresso);
    outline: none;
  }

  /* Add to cart */
  .pdp-add-btn {
    width: 100%; padding: 1.1rem 3rem; background: var(--espresso); color: var(--sand-light);
    font-family: 'Outfit', sans-serif; font-size: 0.75rem; letter-spacing: 0.25em;
    text-transform: uppercase; border: none; cursor: pointer;
    position: relative; overflow: hidden; transition: all 0.5s ease;
  }
  .pdp-add-btn::before {
    content: ''; position: absolute; top: 0; left: -100%;
    width: 100%; height: 100%; background: var(--gold);
    transition: left 0.5s ease; z-index: 0;
  }
  .pdp-add-btn:hover::before { left: 0; }
  .pdp-add-btn span { position: relative; z-index: 1; }
  .pdp-add-btn.added { pointer-events: none; }
  .pdp-add-btn.added::before { left: 0; }

  .pdp-secondary-actions {
    display: flex; gap: 2rem; margin-top: 1.5rem; padding-top: 1.5rem;
    border-top: 1px solid var(--sand);
  }
  .pdp-sec-link {
    font-size: 0.7rem; letter-spacing: 0.15em; text-transform: uppercase;
    color: var(--espresso-soft); text-decoration: none; display: flex; align-items: center; gap: 0.5rem;
    transition: color 0.3s;
  }
  .pdp-sec-link:hover { color: var(--gold); }
  .pdp-sec-link svg { width: 16px; height: 16px; }

  /* Details accordion */
  .pdp-accordion { margin-top: 2.5rem; }
  .acc-item { border-top: 1px solid var(--sand); }
  .acc-item:last-child { border-bottom: 1px solid var(--sand); }
  .acc-header {
    display: flex; justify-content: space-between; align-items: center;
    padding: 1.3rem 0; cursor: pointer; user-select: none;
  }
  .acc-header-text {
    font-size: 0.7rem; letter-spacing: 0.2em; text-transform: uppercase; color: var(--espresso);
  }
  .acc-icon {
    width: 12px; height: 12px; position: relative;
    transition: transform 0.3s;
  }
  .acc-icon::before, .acc-icon::after {
    content: ''; position: absolute; background: var(--espresso);
  }
  .acc-icon::before { width: 12px; height: 1px; top: 5.5px; left: 0; }
  .acc-icon::after { width: 1px; height: 12px; left: 5.5px; top: 0; transition: transform 0.3s; }
  .acc-item.open .acc-icon::after { transform: rotate(90deg); }
  .acc-body {
    max-height: 0; overflow: hidden; transition: max-height 0.4s ease, padding 0.4s ease;
  }
  .acc-item.open .acc-body { max-height: 300px; padding-bottom: 1.5rem; }
  .acc-body-inner {
    font-size: 0.85rem; line-height: 1.8; color: var(--espresso-soft);
  }
  .acc-body-inner ul { list-style: none; }
  .acc-body-inner li { padding: 0.3rem 0; display: flex; align-items: center; gap: 0.8rem; }
  .acc-body-inner li::before {
    content: ''; width: 4px; height: 4px; border-radius: 50%;
    background: var(--gold); flex-shrink: 0;
  }

  /* Related */
  .related { padding: 6rem 4rem 8rem; background: var(--sand-pale); }
  .related-header { text-align: center; margin-bottom: 4rem; }
  .related-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 2.5rem; max-width: 1300px; margin: 0 auto; }
  .related .product-card { opacity: 1; transform: none; animation: none; }
  .product-image { aspect-ratio: 3/4; position: relative; overflow: hidden; margin-bottom: 1.5rem; }
  .product-bg { position: absolute; inset: 0; transition: transform 0.8s ease; }
  .product-card:hover .product-bg { transform: scale(1.05); }
  .product-shape { position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; z-index: 1; }
  .product-shape svg { width: 50%; height: auto; filter: drop-shadow(0 15px 40px rgba(44,24,16,0.15)); transition: transform 0.6s ease; }
  .product-card:hover .product-shape svg { transform: translateY(-8px) rotate(-2deg); }
  .product-badge { position: absolute; top: 1.2rem; left: 1.2rem; padding: 0.4rem 1rem; background: rgba(255,252,247,0.9); backdrop-filter: blur(10px); font-size: 0.6rem; letter-spacing: 0.2em; text-transform: uppercase; color: var(--gold); z-index: 2; }
  .product-name { font-family: 'Cormorant Garamond', serif; font-size: 1.4rem; font-weight: 400; margin-bottom: 0.3rem; }
  .product-meta { display: flex; justify-content: space-between; align-items: center; }
  .product-type { font-size: 0.7rem; letter-spacing: 0.15em; text-transform: uppercase; color: var(--espresso-soft); }
  .product-price { font-family: 'Cormorant Garamond', serif; font-size: 1.2rem; color: var(--gold); }
  .product-card { text-decoration: none; color: var(--espresso); display: block; }

  @media (max-width: 1024px) {
    .pdp-grid { grid-template-columns: 1fr; gap: 3rem; }
    .pdp-gallery { position: static; }
    .related-grid { grid-template-columns: repeat(2, 1fr); }
  }
  @media (max-width: 768px) {
    .pdp { padding: 7rem 2rem 4rem; }
    .related { padding: 4rem 2rem 5rem; }
    .related-grid { grid-template-columns: 1fr; max-width: 380px; margin: 0 auto; }
    .pdp-thumbs { gap: 0.5rem; }
    .pdp-thumb { width: 60px; height: 75px; }
  }
</style>
</head>
<body>
<div class="grain"></div>
<div class="cursor-dot" id="cursorDot"></div>
<div class="cursor-ring" id="cursorRing"></div>

<nav id="navbar" class="nav-light">
  <a href="index.html" class="logo">Rafia<span>.</span></a>
  <ul class="nav-center">
    <li><a href="shop.html">Collection</a></li>
    <li><a href="index.html#story">Our Story</a></li>
    <li><a href="index.html#values">Savoir-Faire</a></li>
    <li><a href="index.html#contact">Contact</a></li>
  </ul>
  <div class="nav-right">
    <a href="cart.html" class="cart-icon" title="Shopping Bag">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 01-8 0"/></svg>
      <span class="cart-count" style="display:none;">0</span>
    </a>
    <div class="menu-toggle" id="menuToggle"><span></span><span></span><span></span></div>
  </div>
</nav>

<section class="pdp">
  <div class="pdp-grid">
    <div class="pdp-gallery" id="pdpGallery"></div>
    <div class="pdp-info" id="pdpInfo"></div>
  </div>
</section>

<section class="related" id="relatedSection">
  <div class="related-header">
    <p class="section-tag centered">You May Also Like</p>
    <h2 class="section-title" style="text-align:center">More <em>Pieces</em></h2>
  </div>
  <div class="related-grid" id="relatedGrid"></div>
</section>

<footer>
  <div class="footer-top">
    <div class="footer-brand"><a href="index.html" class="logo">Rafia<span>.</span></a><p class="footer-desc">Artisanal raphia bags, handcrafted in Madagascar.</p></div>
    <div><p class="footer-heading">Shop</p><ul class="footer-links"><li><a href="shop.html">All Bags</a></li><li><a href="shop.html">Totes</a></li><li><a href="shop.html">Clutches</a></li></ul></div>
    <div><p class="footer-heading">About</p><ul class="footer-links"><li><a href="index.html#story">Our Story</a></li><li><a href="#">Artisans</a></li><li><a href="#">Sustainability</a></li></ul></div>
    <div><p class="footer-heading">Help</p><ul class="footer-links"><li><a href="#">Shipping</a></li><li><a href="#">Returns</a></li><li><a href="#">Care Guide</a></li></ul></div>
  </div>
  <div class="footer-bottom"><span>&copy; 2025 Rafia. All rights reserved.</span><div class="footer-social"><a href="#">Instagram</a><a href="#">Pinterest</a><a href="#">Facebook</a></div></div>
</footer>

<script src="products.js"></script>
<script src="shared.js"></script>
<script>
  const params = new URLSearchParams(window.location.search);
  const productId = params.get('id') || PRODUCTS[0].id;
  const product = getProduct(productId) || PRODUCTS[0];
  let qty = 1;

  document.title = product.name + ' — Rafia';

  // Gallery
  document.getElementById('pdpGallery').innerHTML = `
    <div class="pdp-main-image">
      <div class="pdp-main-bg" style="background:${product.gradient}"></div>
      <div class="pdp-main-shape">${product.svg}</div>
      ${product.badge ? `<span class="pdp-badge-abs">${product.badge}</span>` : ''}
    </div>
    <div class="pdp-thumbs">
      <div class="pdp-thumb active" style="background:${product.gradient}">${product.svg}</div>
      <div class="pdp-thumb" style="background:linear-gradient(145deg, var(--sand) 0%, var(--sand-light) 100%)">${product.svg}</div>
      <div class="pdp-thumb" style="background:linear-gradient(145deg, var(--gold-light) 0%, var(--sand) 100%)">${product.svg}</div>
    </div>`;

  // Info
  document.getElementById('pdpInfo').innerHTML = `
    <div class="pdp-breadcrumb">
      <a href="index.html">Home</a><span class="sep">/</span>
      <a href="shop.html">Collection</a><span class="sep">/</span>
      <span>${product.name}</span>
    </div>
    <p class="pdp-type">${product.type}</p>
    <h1 class="pdp-name">${product.name}</h1>
    <p class="pdp-price">CHF ${product.price}</p>
    <div class="pdp-divider"></div>
    <p class="pdp-desc">${product.description}</p>
    <p class="pdp-option-label">Colour — <strong style="font-weight:400;color:var(--espresso)">${product.color}</strong></p>
    <div class="pdp-color-row">
      <div class="color-swatch sw-natural active" title="Natural"></div>
      <div class="color-swatch sw-honey" title="Honey"></div>
      <div class="color-swatch sw-sand" title="Sand"></div>
    </div>
    <p class="pdp-option-label">Quantity</p>
    <div class="pdp-qty-row">
      <div class="qty-control">
        <button class="qty-btn" id="qtyMinus">&minus;</button>
        <input type="text" class="qty-val" id="qtyVal" value="1" readonly>
        <button class="qty-btn" id="qtyPlus">+</button>
      </div>
    </div>
    <button class="pdp-add-btn" id="addToCartBtn"><span>Add to Bag — CHF ${product.price}</span></button>
    <div class="pdp-secondary-actions">
      <a href="#" class="pdp-sec-link">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"/></svg>
        Add to Wishlist
      </a>
      <a href="#" class="pdp-sec-link">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/></svg>
        Share
      </a>
    </div>
    <div class="pdp-accordion">
      <div class="acc-item open">
        <div class="acc-header"><span class="acc-header-text">Product Details</span><div class="acc-icon"></div></div>
        <div class="acc-body"><div class="acc-body-inner"><ul>${product.details.map(d => '<li>' + d + '</li>').join('')}</ul></div></div>
      </div>
      <div class="acc-item">
        <div class="acc-header"><span class="acc-header-text">Shipping &amp; Returns</span><div class="acc-icon"></div></div>
        <div class="acc-body"><div class="acc-body-inner"><p>Complimentary shipping within Switzerland. International shipping available. 14-day return policy for unworn items in original packaging.</p></div></div>
      </div>
      <div class="acc-item">
        <div class="acc-header"><span class="acc-header-text">Care Instructions</span><div class="acc-icon"></div></div>
        <div class="acc-body"><div class="acc-body-inner"><p>Store in the provided dust bag when not in use. Avoid prolonged exposure to direct sunlight and moisture. Gently brush with a soft cloth to remove dust.</p></div></div>
      </div>
    </div>`;

  // Quantity controls
  document.getElementById('qtyMinus').addEventListener('click', () => {
    if (qty > 1) { qty--; document.getElementById('qtyVal').value = qty; updatePrice(); }
  });
  document.getElementById('qtyPlus').addEventListener('click', () => {
    qty++; document.getElementById('qtyVal').value = qty; updatePrice();
  });
  function updatePrice() {
    document.querySelector('.pdp-add-btn span').textContent = `Add to Bag — CHF ${product.price * qty}`;
  }

  // Add to cart
  document.getElementById('addToCartBtn').addEventListener('click', () => {
    for (let i = 0; i < qty; i++) {
      RafiaCart.add({ id: product.id, name: product.name, price: product.price, type: product.type, color: product.color, gradient: product.gradient, svg: product.svg });
    }
    const btn = document.getElementById('addToCartBtn');
    btn.classList.add('added');
    btn.querySelector('span').textContent = '✓ Added to Bag';
    setTimeout(() => { btn.classList.remove('added'); updatePrice(); }, 2000);
  });

  // Color swatches
  document.querySelectorAll('.color-swatch').forEach(sw => {
    sw.addEventListener('click', () => {
      document.querySelectorAll('.color-swatch').forEach(s => s.classList.remove('active'));
      sw.classList.add('active');
    });
  });

  // Thumb clicks
  document.querySelectorAll('.pdp-thumb').forEach(th => {
    th.addEventListener('click', () => {
      document.querySelectorAll('.pdp-thumb').forEach(t => t.classList.remove('active'));
      th.classList.add('active');
      document.querySelector('.pdp-main-bg').style.background = th.style.background;
    });
  });

  // Accordion
  document.querySelectorAll('.acc-header').forEach(h => {
    h.addEventListener('click', () => { h.parentElement.classList.toggle('open'); });
  });

  // Related products
  const related = PRODUCTS.filter(p => p.id !== product.id).slice(0, 3);
  const rg = document.getElementById('relatedGrid');
  related.forEach(p => {
    rg.innerHTML += `<a href="product.html?id=${p.id}" class="product-card">
      <div class="product-image"><div class="product-bg" style="background:${p.gradient}"></div><div class="product-shape">${p.svg}</div>${p.badge ? `<span class="product-badge">${p.badge}</span>` : ''}</div>
      <div class="product-meta"><div><h3 class="product-name">${p.name}</h3><p class="product-type">${p.type} &mdash; ${p.color}</p></div><span class="product-price">CHF ${p.price}</span></div></a>`;
  });
</script>
</body>
</html>
